<div class="center" style="height:593px;">
  <%# javascript_include_tag "http://cdn.pubnub.com/pubnub.min.js" %>
  <%# javascript_include_tag "videosync" %>
  <%# javascript_include_tag "stanko" %>
  <div id="player" class="video-wrapper js-video-wrapper" style="max-width:600px; height:100%; padding:0; margin:0;">
    <div class="video-responsive" style="max-width:600px; height:100%; padding:0; margin:0;">
      <!-- <video class="video js-video" muted>
        <source src="http://www.quirksmode.org/html5/videos/big_buck_bunny.webm" type="video/webm" />
        <source src="http://www.quirksmode.org/html5/videos/big_buck_bunny.mp4" type="video/mp4" />
        <source src="http://www.quirksmode.org/html5/videos/big_buck_bunny.ogv" type="video/ogg" />
        Your browser does not support HTML5 video.
      </video> -->
      <%= video_tag @video, "", controls: true, size: '0' %>

      <% if @identity == "first" %>
        <canvas class="canvas js-canvas" id="master"></canvas>
      <% else %>
        <canvas class="canvas js-canvas" id="second"></canvas>
      <% end %>
      <div class="video-timeline js-timeline">
        <div class="video-timeline-passed js-timeline-passed"></div>
      </div>
    </div>
  </div>
  <script>
    document.getElementsByTagName('video')[0].className += "video js-video";
    var rand = Math.random().toString();

    var vidSync = new VideoSync('<%= @channel_name %>', 'Player' + rand);

    var player = new CanvasVideoPlayer({
      videoSelector: '.js-video',
      canvasSelector: '.js-canvas',
      timelineSelector: '.js-timeline',
      audio: true,
      PBonPlayerReady : vidSync.onPlayerReady,
      PBonPlayerStateChange : vidSync.onPlayerStateChange
    });

  </script>
</div>
